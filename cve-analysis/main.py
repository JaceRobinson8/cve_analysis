import sqlite3
import logging
from rich.logging import RichHandler

logger = logging.getLogger(__name__)


def main() -> None:
    logger.info("Connecting to db")
    con = sqlite3.connect("tutorial.db")
    cur = con.cursor()
    # cur.execute("CREATE TABLE movie(title, year, score)")
    res = cur.execute("SELECT name FROM sqlite_master")
    logger.info(res.fetchone())
    cur.execute("""
    INSERT INTO movie VALUES
        ('Monty Python and the Holy Grail', 1975, 8.2),
        ('And Now for Something Completely Different', 1971, 7.5)
    """)
    con.commit()
    res = cur.execute("SELECT score FROM movie")
    logging.info(res.fetchall())


if __name__ == "__main__":
    logging.basicConfig(
        level=logging.DEBUG,
        format="%(message)s",
        datefmt="[%X]",
        handlers=[RichHandler()],
    )
    main()
